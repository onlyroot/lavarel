function Dialog(g,l){var d={title:"分享宝贝到社区",showTitle:true,closeText:"关闭窗口",draggable:true,modal:true,center:true,fixed:true,time:0,id:false};var l=$.extend(d,l);l.id=l.id?l.id:"dialog-"+Dialog.__count;var f=l.id+"-overlay";var a=null;var e=false;var j=$.browser.msie;var c=$.browser.msie&&("6.0"==$.browser.version);var i=!l.showTitle?"":'<div class="bar"><span class="title">'+l.title+'</span><a class="close">'+l.closeText+"</a></div>";var h=$('<div id="'+l.id+'" class="dialog">'+i+'<div class="content"></div></div>').hide();$("body").append(h);var b=function(){if(l.center){var n=($(window).width()-h.width())/2;var m=($(window).height()-h.height())/2;if(!c&&l.fixed){h.css({top:m,left:n})}else{h.css({top:m+$(document).scrollTop(),left:n+$(document).scrollLeft()})}}};var k=function(){if(l.modal){$("body").append('<div id="'+f+'" class="dialog-overlay"></div>');if(c){$("#"+f).css({left:0,top:0,width:"100%",height:$(document).height(),"z-index":++Dialog.__zindex,position:"absolute"}).hide()}else{$("#"+f).css({left:0,top:0,width:"100%",height:"100%","z-index":++Dialog.__zindex,position:"fixed"}).hide()}}h.css({"z-index":++Dialog.__zindex,position:l.fixed?"fixed":"absolute"});if(c&&l.fixed){h.css("position","absolute");b();var p=parseInt(h.css("top"))-$(document).scrollTop();var o=parseInt(h.css("left"))-$(document).scrollLeft();$(window).scroll(function(){h.css({top:$(document).scrollTop()+p,left:$(document).scrollLeft()+o})})}var m={x:0,y:0};function n(q){var t=window.event||q;var s=parseInt(h.css("top"))+(t.clientY-m.y);var r=parseInt(h.css("left"))+(t.clientX-m.x);h.css({top:s,left:r});m.x=t.clientX;m.y=t.clientY}h.find(".bar").mousedown(function(q){if(!l.draggable){return}var r=window.event||q;m.x=r.clientX;m.y=r.clientY;$(document).bind("mousemove",n)});$(document).mouseup(function(q){$(document).unbind("mousemove",n)});h.find(".close").bind("click",this.close);h.bind("mousedown",function(){h.css("z-index",++Dialog.__zindex)});if(0!=l.time){a=setTimeout(this.close,l.time)}};this.setContent=function(n){var m=h.find(".content");if("object"==typeof(n)){switch(n.type.toLowerCase()){case"id":m.html($("#"+n.value).html());break;case"img":m.html("加载中...");$('<img alt="" />').load(function(){m.empty().append($(this));b()}).attr("src",n.value);break;case"url":m.html("加载中...");$.ajax({url:n.value,success:function(o){m.html(o);b()},error:function(p,q,o){m.html("出错啦")}});break;case"iframe":m.append($('<iframe src="'+n.value+'" />'));break;case"text":default:m.html(n.value);break}}else{m.html(n)}};this.show=function(){if(undefined!=l.beforeShow&&!l.beforeShow()){return}var m=function(o){if(!j){return $("#"+o).css("opacity")}var n=document.getElementById(o);return(undefined!=n&&undefined!=n.filters&&undefined!=n.filters.alpha&&undefined!=n.filters.alpha.opacity)?n.filters.alpha.opacity/100:1};if(l.modal){$("#"+f).fadeTo("fast",m(f))}h.fadeTo("fast",m(l.id),function(){if(undefined!=l.afterShow){l.afterShow()}e=true});if(0!=l.time){a=setTimeout(this.close,l.time)}b()};this.hide=function(){if(!e){return}if(undefined!=l.beforeHide&&!l.beforeHide()){return}h.fadeOut("slow",function(){if(undefined!=l.afterHide){l.afterHide()}});if(l.modal){$("#"+f).fadeOut("fast")}e=false};this.close=function(){if(undefined!=l.beforeClose&&!l.beforeClose()){return}h.fadeOut("slow",function(){$(this).remove();e=false;if(undefined!=l.afterClose){l.afterClose()}});if(l.modal){$("#"+f).fadeOut("fast",function(){$(this).remove()})}clearTimeout(a)};k.call(this);this.setContent(g);Dialog.__count++;Dialog.__zindex++}Dialog.__zindex=500;Dialog.__count=1;Dialog.version="1.0 beta";function dialog(b,a){var c=new Dialog(b,a);c.show();return c};